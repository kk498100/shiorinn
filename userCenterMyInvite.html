<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>用户中心-兑换佣金报表</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
</head>

<body class="bg-f8">
    <!-- header -->
    <!--#include file ="./userCenterHead.html"-->
    <!-- user container -->
    <div class="g-container d-flex justify-content-between mx-auto user">
        <!-- left -->
        <!--#include file ="./aside.html"-->
        <!-- right -->
        <div class="g-content">
            <div class="carousel slide ident-top-carousel" data-ride="Carouse" id="identTopCarouse">
                <ol class="carousel-indicators">
                    <li data-target="#identTopCarouse" data-slide-to="0" class="active"></li>
                    <li data-target="#identTopCarouse" data-slide-to="1"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <a href="//lp.ls24k.com/active/lp_190605gg76w9hp.html" target="_blank"><img src="./images/up-img-top-banner1.png" class="w-100"></a>
                    </div>
                    <div class="carousel-item">
                        <a href="//www.ls24k.com/about.html" target="_blank"><img src="./images/up-img-top-banner2.png" class="w-100"></a>
                    </div>
                </div>
            </div>

            <div class="bg-ff invite-main user-main">
                <strong class="recoed-main-top fz18 s-fcc09 d-block">我的邀请用户</strong>
                <div class="invite-main-content">
                    <div class="invite-main-top-title d-flex justify-content-center"><strong class="fz24 s-fcc09 position-relative">推荐方式</strong></div>
                    <div class="invite-method d-flex justify-content-center">
                        <div class="invite-method-i position-relative">
                            <div class="invite-method-title text-white bg-c09a57 text-center">邀请链接</div>
                            <div class="invite-method-link" id="inviteLink"></div>
                            <button class="btn text-white bg-c09a57 fz18" id="inviteBtn">一键复制</button>
                        </div>
                        <div class="invite-method-i position-relative">
                            <div class="invite-method-title text-white bg-42d text-center">二维码邀请</div>
                            <div class="invite-method-code" id="inviteCode"></div>
                            <div class="invite-msg">这是您的专属邀请二维码，打开微信“扫一扫”，点击右上角“发送给朋友”或“分享给朋友”</div>
                        </div>
                    </div>
                    <div class="d-flex flex-nowrap justify-content-around text-center align-self-center invite-detail">
                        <span><i class="s-fcc09 fz24" clientnum></i><p class="fz14 s-fc99">邀请好友总人数</p></span>
                        <span class="line"></span>
                        <span><i class="s-fcc09 fz24" validclientnum></i><p class="fz14 s-fc99">有效好友人数</p></span>
                        <span class="line"></span>
                        <span><i class="s-fcc09 fz24" yaoqing></i><p class="fz14 s-fc99">邀请获得佣金(美元)</p></span>
                        <span class="line"></span>
                        <span><i class="s-fcc09 fz24" jiaoyi></i><p class="fz14 s-fc99">交易获得佣金(美元)</p></span>
                        <span class="line"></span>
                        <span><i class="s-fcc09 fz24" count></i><p class="fz14 s-fc99">累计获得佣金(美元)</p></span>
                        <span class="line"></span>
                        <span><i class="s-fcc09 fz24" money></i><p class="fz14 s-fc99">可兑现佣金(美元)</p></span>
                    </div>
                    <button class="invite-conv-btn text-white fz18 mx-auto bg-c09a57" id="cashBtn">兑现佣金</button>
                    <table class="w-100 invite-detail-table" id="inviteTable"></table>
                    <div class="pages d-flex justify-content-center fz14" id="pages"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- footer -->
    <!--#include file ="./footer.html"-->

    <!-- server -->
    <!--#include file ="./userCenterServer.html"-->

    <script src="js/jquery.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="js/jquery.lazyload.min.js"></script>
    <script src="./js/popup.js"></script>
    <script src="./js/jquery.qrcode.min.js"></script>
    <script src="./js/jq-paginator.min.js"></script>
    <script src="./js/jquery.cookie.js"></script>
    <script src="js/common.js"></script>
    <script src="js/userCenter.js"></script>
    <script>
        asideGuid(12);
        
        $(function() {
            var infores = $.ajaxMethod({url:"info/basic",async:false});
            if(infores.data.account === (1||2)){
                $.popupMethod({
                    content:"您的账户未激活，请先激活账户！"
                });
                $(".modal").on("hidden.bs.modal",function(){
                    window.location.href="./userCenterUp.html";
                });
            }
            var page =  $.render();
            var total = page.data.total, size = page.data.size;
            if(total > size){
                var totalPages = Math.ceil(total/size);
                $("#pages").jqPaginator({
                    totalPages: totalPages,  //总共多少页
                    visiblePages: 5, //最多显示分页数
                    currentPage: 1, // 初始显示第几页
                    first: '<a href="javascript:void(0);">首页<\/a>',
                    prev: '<a href="javascript:void(0);">上一页<\/a>',
                    next: '<a href="javascript:void(0);">下一页<\/a>',
                    last: '<a href="javascript:void(0);">尾页<\/a>',
                    page: '<a href="javascript:void(0);">{{page}}<\/a>',
                    onPageChange: function(n) {
                        $.render({pages:n});
                    }
                });
                }else{
                    $("#pages").hide();
                };
            if(page.data.qr_code){
                $("#inviteLink").html(page.data.qr_code);
                $("#inviteCode").qrcode({
                    width: 128,
                    height: 128,
                    text:page.data.qr_code
                });
            }

            $("#inviteBtn").on("click",function(){
                var input = document.createElement('input');
                document.body.appendChild(input);
                input.setAttribute("readonly","readonly");
                input.setAttribute("value",page.data.qr_code);
                input.select();
                // input.setSelectionRange(0, 9999);
                if (document.execCommand('copy')) {
                    document.execCommand('copy');
                    $("body").append("<div class='exec-pop text-white'>链接已成功复制到剪贴板</div>");
                    $(".exec-pop").fadeIn("300");
                    setTimeout(function(){
                        $(".exec-pop").fadeOut("300");
                        $(".exec-pop").remove();
                    },2000);
                }
                document.body.removeChild(input);

            });

            $("#cashBtn").on("click",function(){
                $.popupMethod({
                    style:"cash-pop",
                    content:"<div class='title'>兑现佣金</div>" +
                            "<p class='cash-i'><label>可兑现佣金：</label>"+page.data.money+"<i>美元</i></P>" +
                            "<p class='cash-i'><label>兑现佣金：</label><input type='text' id='cashPopPut'><i>美元</i></p>" +
                            "<p class='cash-i'><label>实际到账金额：</label><span id='actualMoney'>0</span><i>美元</i></p>" + 
                            "<button type='btn' class='cash-btn' id='cashSubbtn'>提交</button>" + 
                            "<div class='fz14 cash-msg'><div>兑现注意事项：</div><div>在工作日期间，今天16：30前提交，我们将今日处理，16：30之后，将会次日处理。</div></div>"
                });

                $("#cashPopPut").on("keydown",function(){
                    $.process(cashHandle);
                });


                $("#cashSubbtn").on("click",function(){
                    var amount = $("#cashPopPut").val().toString();
                    var res = $.ajaxMethod({url:"brokerage/cash_add",type:"POST",data:{amount:amount},async:false});
                    switch (res.code) {
                        case 0:
                            $.popupMethod({title:"申请失败",content:res.msg});
                            break;
                        case 1:
                            $.popupMethod({title:"申请成功",content:res.msg});
                            break;
                        default:
                            break;
                    }
                });
            });

            
            function cashHandle(){
                var money = $("#cashPopPut").val().toString();
                $("#actualMoney").html(money);
            }
        });

        $("#cashBtn").on("click",function(){
            
        });

        (function($){
            $.extend({
                render:function(o){
                    var d = {
                        pages:1,
                        size:10
                    }
                    var o = $.extend(d,o);
                    var res = $.ajaxMethod({url:"info/activity",async:false,data:o});
                    $(".invite-detail [clientnum]").html(res.data.clientnum);
                    $(".invite-detail [validclientnum]").html(res.data.validclientnum);
                    $(".invite-detail [yaoqing]").html(res.data.yaoqing);
                    $(".invite-detail [jiaoyi]").html(res.data.jiaoyi);
                    $(".invite-detail [count]").html(res.data.count);
                    $(".invite-detail [money]").html(res.data.money);
                    var $HTML = new Array(), total = res.data.total, size = res.data.size;
                    $HTML.push("<table><tr class='title fz22 s-fcc09'><td colspan='4'>邀请用户</td></tr>");
                    $HTML.push("<tr class='s-fcc09 fw800'><th>邀请用户</th><th>邀请日期</th><th>状态</th><th>手数</th></tr>");
                    if(res.data.list.length === 0){
                        $HTML.push("<tr><td colspan='4'>暂无记录！</td></tr>");
                    }else{
                        var len = res.data.list.length , i = len;
                        for( len ; len--; ){
                            var j = i-len- 1, status;
                            switch (res.data.list[j].status) {
                                case 0:
                                    status = "有效";
                                    break;
                                case 1:
                                    status = "无效";
                                    break;
                            };
                            $HTML.push("<tr><td><span>"+res.data.list[j].username+"</span></td>");
                            $HTML.push("<td>"+res.data.list[j].createtime+"</td>");
                            $HTML.push("<td>"+status+"</td>");
                            $HTML.push("<td>"+res.data.list[j].num+"</td></tr>");
                        }
                    }
                    $HTML.push("</table>");
                    var str = $HTML.join("");
                    $("#inviteTable").html(str);
                    return res;
                }
            });
        })(jQuery);
    </script>
</body>

</html>